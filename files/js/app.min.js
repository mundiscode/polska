$(document).ready(function(){initAutocomplete();initLightbox();$("#filtryPlacowek").on("change","#selectWojewodztwo",function(a){var b=citySelection($(this).val())});$("a.contact-order-slide").on("click",function(a){if($("div.contact-order-slide").is(":visible")){$("div.contact-order-slide").slideUp()}else{$("div.contact-order-slide").slideDown()}return false});showAuthorLabel();selectMedicalCategory();selectMedicalSpecialization();selectHealthCategory();initPlaceListTypeChanger();initProductListTypeChanger();rateArticle();ContactLens.tabs();ContactLens.init();beforeLogout();cookieClose();hoverBoxProfile();initIOSClick();initAnimateTo();mobilePhoneNumberFix("inpuTelefon");productCard();if($("#js-messenger").length>0){window.messageBox=new MessageBox("#js-messenger")}});function initAutocomplete(){var a=-1;if($("#autocompleteSearch").val().length>0){$(".erase-input").show()}$("#autocompleteSearch").autocomplete({minLength:0,delay:300,search:function(b,c){if(b.keyCode==40||b.keyCode==38||b.keyCode==13||b.keyCode==46){if(b.keyCode==40){a++;if(a>$("#autocompleteSearchResult .search__section").find("ul li").length-1){a=0}setActiveSearchResult(a)}else{if(b.keyCode==38){a--;if(a<0){a=$("#autocompleteSearchResult .search__section").find("ul li").length-1}setActiveSearchResult(a)}else{if(b.keyCode==46){$("#autocompleteSearch").val("")}}}b.preventDefault()}else{if(b.keyCode==37||b.keyCode==39){b.preventDefault()}}},source:function(c,b){if(c.term.length>2){$(".erase-input").show();$.ajax({url:"/apteka/autocomplete",dataType:"json",data:{q:c.term},beforeSend:function(){},success:function(d){a=-1;$("#autocomplete").remove();if(d.productsCount!==undefined&&d.productsCount===0&&d.articlesCount!==undefined&&d.articlesCount===0&&d.suggestionsCount!==undefined&&d.suggestionsCount===0){$("#page-content-cover").removeClass("active");_gaq.push(["_trackEvent","TraceClicks","V2_EmptySearchAutocomplite","TERM"+c.term]);return}if(d.html!==undefined&&(d.productsCount>0||d.articlesCount>0||d.suggestionsCount>0)){$("#autocompleteSearchResult").html(d.html);$("#autocompleteSearchResult").show();$("#page-content-cover").addClass("active")}}})}else{if(c.term.length>0&&c.term.length<=2){$("#page-content-cover").removeClass("active");$("#autocompleteSearchResult").hide()}else{if(c.term.length==0){$(".erase-input").hide();showHistoryPhrase()}else{$("#autocompleteSearchResult").show();$("#page-content-cover").addClass("active")}}}}}).focus(function(b){if($("#autocompleteSearchResult .search__section").length>0){$("#autocompleteSearchResult").show();$("#page-content-cover").addClass("active")}})}function showHistoryPhrase(){var a=JSON.parse(localStorage.getItem("searchHistory"))||[];var c='    <section class="search__section">\n        <a>\n            <img src="/skin/assets/doz/images/icons/search_local.png" alt="">\n            <h5>OSTATNIO SZUKANE</h5>\n        </a>\n        <ul>\n        </ul>\n    </section>';if(a.length>0&&$("#autocompleteSearch").val()===""){$("#autocompleteSearchResult").html(c);var b=$("#autocompleteSearchResult .search__section ul");var d=0;$.each(a,function(f,j){if(d<=5){d++;var k=$("<li/>",{"class":"clearfix"}).appendTo(b);var e=$("<a/>",{"class":"search__link fade-in-out","data-gtmevent":"localHistory",href:"/apteka/szukaj?search="+encodeURIComponent(j.searchText)}).appendTo(k);var h=$("<span/>",{"class":"search-history",text:j.searchText}).appendTo(e);var l=$("<button/>",{"class":"delete_from_history"}).appendTo(e);var g=$("<img/>",{src:"/skin/assets/doz//images/icons/ic_close-dark.svg"}).appendTo(l)}});$("#autocompleteSearchResult").show();$("#page-content-cover").addClass("active")}}function addSearchHistory(c){if(c!=""){var b=JSON.parse(localStorage.getItem("searchHistory"))||[]}b.reverse();var a={searchText:c};b=removeLocalStorageSearchHistory(c,b);b.push(a);b.reverse();localStorage.setItem("searchHistory",JSON.stringify(b))}function removeLocalStorageSearchHistory(b,a){return jQuery.grep(a,function(c){return c.searchText!=b})}function setActiveSearchResult(a){$("#autocompleteSearchResult .search__section ul li a").removeClass("active-key").eq(a).addClass("active-key");$(".search .input-group form").submit(function(b){b.preventDefault();b.stopPropagation();window.location=$("#autocompleteSearchResult .search__section ul li a").eq(a).attr("href")})}$("body").delegate(".search__section li a button","click",function(b){var a=$(this).parent().text();var c=JSON.parse(localStorage.getItem("searchHistory"))||[];c=removeLocalStorageSearchHistory(a,c);localStorage.setItem("searchHistory",JSON.stringify(c));$(this).parent().parent().remove();if($("#autocompleteSearchResult .search__section ul li").length==0){$("#autocompleteSearchResult").hide();$("#page-content-cover").removeClass("active");$(".search__section").remove()}b.preventDefault();b.stopPropagation()});$("body").delegate(".erase-input","click",function(a){$("#autocompleteSearch").val("");$(this).hide()});$("body").delegate(".search__section ul li a.search__link","click",function(a){sendGoogleEvent($(this).data("gtmevent"));addSearchHistory($("#autocompleteSearch").val())});function sendGoogleEvent(a){_gaq.push(["_trackEvent","TraceClicks","Autocompliter",$("#autocompleteSearch").val()+"_"+a]);return true}$(".search .input-group form").submit(function(b){var a=$(".active-key").data("gtmevent");if(typeof a==="undefined"||a===null||a===""){sendGoogleEvent("searchButton")}else{sendGoogleEvent(a)}addSearchHistory($("#autocompleteSearch").val())});$("body").click(function(b){var a=$(b.target);if(((!a.hasClass("main-search-input")&&!a.hasClass("search__hints")&&a.closest(".main-search-input").length===0&&a.closest("#autocompleteSearchResult").length===0)||(a.hasClass("search__link")||a.closest(".search__link").length>0))&&$("#autocompleteSearchResult").children().length>0){$("#autocompleteSearchResult").hide();$("#page-content-cover").removeClass("active")}});function initLightbox(){if(!($(".lightbox").length>0)){return false}$(".lightbox > a").lightBox({fixedNavigation:true})}function citySelection(a){if(a<=0){return false}$.ajax({type:"POST",url:"/ajaxlekarze/m"+a+"_-Miasta",data:{},dataType:"json",success:function(b){if(b.result==1){var d=b.cities;var e=$("#selectMiasto").empty();var c=$("<option></option>").val("").text("miasto");e.append(c);$.each(d,function(f,h){var g=$("<option></option>").val(h.id).text(h.name);e.append(g)});e.val("");e.select2Init()}else{$("#systemError").show()}},error:function(){}});return false}function initPlaceListTypeChanger(){var a=getCookie("placesListType");$(".placesSearchListType .js-button-box, .placesSearchListType  .js-button-list").on("click",function(b){b.preventDefault();setPlaceListType($(this))})}function setPlaceListType(a){if($(a).hasClass("js-button-box")){$(".place__article.sort-menu").addClass("place__article--box").removeClass("place__article--list");var b=$(".placesList");b.find(".placeCardBoxContainer").addClass("col-sm-6 col-md-4");b.find(".place-card").removeClass("place--list-item").addClass("place--medium2").find(".place__options").addClass("place__options--small");setCookie("placesListType","box",84000)}else{$(".place__article.sort-menu").removeClass("place__article--box").addClass("place__article--list");var b=$(".placesList");b.find(".placeCardBoxContainer").removeClass("col-sm-6 col-md-4");b.find(".place-card").addClass("place--list-item").removeClass("place--medium2").find(".place__options").removeClass("place__options--small");setCookie("placesListType","list",84000)}}function initProductListTypeChanger(){$(".productListType .js-button-box, .productListType .js-button-list").on("click",function(a){a.preventDefault();setProductListType($(this))})}function setProductListType(a){if($(a).hasClass("js-button-box")){$(".product__article").addClass("product__article--box").removeClass("product__article--list");$("#productsContainer > div.row > div, #search-products > div.row > div").each(function(b,c){$(c).removeClass("col-xs-custom-6 col-xs-12");$(c).addClass("col-xs-custom-6 col-sm-4")});setCookie("productListType","box",84000)}else{$(".product__article").addClass("product__article--list").removeClass("product__article--box");$("#productsContainer > div.row > div,  #search-products > div.row > div").each(function(b,c){$(c).removeClass("col-xs-custom-6 col-sm-4");$(c).addClass("col-xs-custom-6 col-xs-12")});setCookie("productListType","list",84000)}}function showAuthorLabel(){$(".article__autor, .tip__autor").find("img").on("mouseover",function(){element=$(this).parent().parent().find('.layer-tool-container[author-id="'+$(this).attr("for-author-id")+'"]');element.addClass("active")});$(".article__autor, .tip__autor").find("a[for-author-id]").on("mouseover",function(){element=$(this).parent().find('.layer-tool-container[author-id="'+$(this).attr("for-author-id")+'"]');element.addClass("active")});$(".article__autor, .tip__autor").find("img").on("mouseleave",function(){element=$(this).parent().parent().find('.layer-tool-container[author-id="'+$(this).attr("for-author-id")+'"]');element.removeClass("active")});$(".article__autor, .tip__autor").find("a[for-author-id]").on("mouseleave",function(){element=$(this).parent().find('.layer-tool-container[author-id="'+$(this).attr("for-author-id")+'"]');element.removeClass("active")});$(".layer-tool-container").on("mouseover",function(){$(this).addClass("active")});$(".layer-tool-container").on("mouseleave",function(){$(this).removeClass("active")})}function setCookie(b,f,c){var e=new Date();e.setTime(e.getTime()+(c*60*60*1000));var a="expires="+e.toUTCString();document.cookie=b+"="+f+"; "+a+";path=/"}function getCookie(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""}function selectMedicalSpecialization(){$("#medicalSpecializationSelect").on("change",function(){if($("#medicalSpecializationSelect").val()!==null&&$("#medicalSpecializationSelect").val()!==""){window.location=$("#medicalSpecializationSelect").val()}})}function selectMedicalCategory(){$("#medicalCategorySelect").on("change",function(){if($("#medicalCategorySelect").val()!==null&&$("#medicalCategorySelect").val()!==""){window.location=$("#medicalCategorySelect").val()}})}function selectHealthCategory(){$("select[id^=health_group_]").on("change",function(){if($(this).val()!==null&&$(this).val()!==""){window.location=$(this).val()}})}function rateArticle(){$("a.rate-article-js").hover(function(){$(this).parent().find("a").each(function(a,b){$(b).removeClass("star-empty");$(b).addClass("star-fill");if($(b).is(":hover")){return false}});$(this).removeClass("star-empty");$(this).addClass("star-fill")},function(){$(this).parent().find("a.star-fill").each(function(a,b){$(this).removeClass("star-fill");$(this).addClass("star-empty")})})}function tooltipRefresh(a,b){if(a===undefined||$(a).length===0){return false}if(b===undefined){var b={}}if(b.delay===undefined){b.delay=0}setTimeout(function(){$(a).tooltip("show")},b.delay)}function tooltipHide(a){if(a===undefined||$(a).length===0){return false}$(a).tooltip("hide")}function tooltipDestroy(a){if(a===undefined||$(a).length===0){return false}$(a).tooltip("hide");$(a).on("hidden.bs.tooltip",function(){$(a).removeAttr("data-original-title").removeClass("input-succes").removeClass("input-error")})}function beforeLogout(){$(".beforeLogout").on("click",function(b){var a=new Dialog("#beforeLogout");if($("#beforeLogout").length>0){b.preventDefault();a.show();return false}})}function cookieClose(){var a=getCookie("cookieAccept");if(a!=="true"){$("div.alert.alert-cookie").show()}$(".alert__close_cookie").on("click",function(){setCookie("cookieAccept","true",84000);$("div.alert.alert-cookie").hide()})}function initIOSClick(){if((navigator.userAgent.match(/iPhone/i))||(navigator.userAgent.match(/iPod/i))||(navigator.userAgent.match(/iPad/i))){var a=false;$("body").on("touchstart",function(){a=false});$("body").on("touchmove",function(){a=true});$(".page__content").on("touchend",".product-box a",function(d){if(!a){var b=$(this);var c=b.attr("href");window.location=c}})}}function hoverBoxProfile(){$(".box--profile .box").hover(function(){$(this).addClass("box--c");$(this).find(".btn").addClass("btn-a")},function(){$(this).removeClass("box--c")})}function initAnimateTo(){if($("[data-animate-to]").length>0){$("[data-animate-to]").on("click",function(a){animateTo('[data-animate-anchor="'+$(this).attr("data-animate-to")+'"]')})}}function animateTo(c){if(typeof $(c)!="object"||$(c).length==0){return false}var b=$(c).offset().top;var a=165;if(($(".menu-main").height()>=70&&$(".menu-main").height()<80)||($(".menu-main").height()>=210&&$(".menu-main").height()<225)){a=95}if($(".menu-main").height()>=139&&$(".menu-main").height()<146){a=25}$("html,body").animate({scrollTop:(b-a)},500,function(){});return false}var ContactLens={eyeAttributes:function(c,a,b){$.each(a,function(e,g){if(c[3]!==e){var d=$("#eyes-"+c[1]+"-opt-"+e);d.empty();d.append('<option value="getall">Wybierz</option>');$.each(g.produkty,function(i,h){if(h.wartosc_aktywna===0){d.append($('<option disabled="disabled"></option>').attr("value",h.wartosc).text(h.wartosc))}else{d.append($("<option></option>").attr("value",h.wartosc).text(h.wartosc))}});if(b[c[1]][e]){var f=b[c[1]][e];$("#eyes-"+c[1]+"-opt-"+e).val(f)}}})},itemAdd:function(a){},itemDel:function(a){},itemCheck:function(b){var a=parseInt($("#"+b).val());if(a<1){a=1}if(a>50){a=50}$("#"+b).attr("value",a)},tabs:function(){$('.product__panel--lenses [name="radioParametr"]').on("change",function(a){var b=$(this).parents(".product__panel--lenses");if($(this).prop("checked")==true&&$(this).val()=="same"){$("#tabCL2").hide();$("#tabCL1").show()}else{$("#tabCL2").show();$("#tabCL1").hide()}})},init:function(){$(".addLensToCartButton").click(function(a){a.preventDefault();$(".quantityEye").each(function(){if($(this).val()>50){$(this).val(50)}else{if($(this).val()<1){$(this).val(1)}}});if($(this).attr("id")=="add-button-1"){$("#formEyes1").submit()}else{if($(this).attr("id")=="add-button-2"){$("#formEyes2").submit()}}});$(".eyeOptSelector").on("change",function(){$("#add-button-1").addClass("hidden");$("#add-button-2").addClass("hidden");var c=$(this).attr("id");var b=c.split("-");var a="formEyes2";if(b[1]==="1"){a="formEyes1"}$.ajax({type:"POST",url:"/ajaxapteka/s0-Szukaj",dataType:"json",data:{id:$("#productId").val(),params:$("#"+a).serialize()},success:function(d){if(a=="formEyes1"){if(d.produkt_1){$("#selected-item-1").val(d.produkt_1);$("#add-button-1").removeClass("hidden")}else{$("#selected-item-1").val("");$("#add-button-1").addClass("hidden")}}if(a=="formEyes2"){if(d.produkt_2){$("#selected-item-2").val(d.produkt_2)}else{$("#selected-item-2").val("")}if(d.produkt_3){$("#selected-item-3").val(d.produkt_3)}else{$("#selected-item-3").val("")}if(d.produkt_2&&d.produkt_3){$("#add-button-2").removeClass("hidden")}else{$("#add-button-2").addClass("hidden")}}if(b[1]==="1"){ContactLens.eyeAttributes(b,d.attributes_1,d.params.eyeparam)}else{ContactLens.eyeAttributes(b,d.attributes_2,d.params.eyeparam);ContactLens.eyeAttributes(b,d.attributes_3,d.params.eyeparam)}$(".eyeOptSelector").select2Init()}});return true})}};function mobilePhoneNumberFix(b){var a="#"+b;$(document).on("blur",a,function(f){var c=$(this).val();if(c.length==0){return}var d=c.match(/^\+48/);if(d!==null){c=c.substr(d[0].length)}c=c.replace(/\D/g,"");var d=c.match(/^0048/);if(d!==null){c=c.substr(d[0].length)}if(c.length>0){c=c.substr(0,9)}$(this).val(c)})}function productCard(){if(!$(".product__page .product_card .product_content .icons ul li").length>0){$(".product__page .product_card .product_content .image_box").addClass("no-icons")}$(document).on("click",".product_card .product-basket .product-basket-add-rx .btn-add",function(a){a.preventDefault();if(productCheckBasketAdd()==true){$(".product_card .product-basket .product-basket-add-rx").submit()}});$(".product-basket-add-rx select.product-refund-select").each(function(){productRefundPriceChoose(this,{gtm:false})});$(".product-basket-add-rx select.product-refund-select").change(function(){productRefundPriceChoose(this)})}function productCheckBasketAdd(b){if(b===undefined){b=false}var a=new FormCheck(".product_card .product-basket-add-rx");var c=true;$(".product-basket-add-rx select.product-refund-select option:selected").each(function(){if($(this).val()=="-"&&b===false){a.error($(this).parent().attr("name"));c=false}else{a.hideError($(this).parent().attr("name"))}});return c}var currenRefundSelectVal;function productRefundPriceChoose(h,b){productCheckBasketAdd(true);var g={};var d=true;var a=$(h);var c=a.find("option:selected").val();var f=a.parents(".product-basket");g[a.attr("name")]=c;if(c!="-"){setCookie("recepta_"+a.attr("name"),c)}if(g.refund_type===undefined){g.refund_type="-"}for(key in g){if(g[key]==="-"){d=false;break}}if(d===false){f.find(".product-price-range").removeClass("hide");f.find(".product-price-refunds").addClass("hide");f.find(".product-price-refund-id").val("PO");$(".product__page .item-box .item-price .product-price-range").removeClass("hide");$(".product__page .item-box .item-price .product-price-refunds").addClass("hide")}else{if(typeof b=="undefined"||typeof b.gtm=="undefined"||b.gtm==true){var e=new GtmEvent();e.recipeFill({refundType:g.refund_type})}}if(d===true&&(g.refund_type==="R"||g.refund_type==="B"||g.refund_type==="30"||g.refund_type==="50"||g.refund_type==="PO")){f.find(".product-price-range").addClass("hide");f.find(".product-price-refunds").addClass("hide");f.find(".product-price-refund_"+g.refund_type).removeClass("hide");f.find(".product-price-refund-id").val(g.refund_type);$(".product__page .item-box .item-price").each(function(){var i=$(this).find(".product-price-refund_"+g.refund_type);if(i.length>0){$(this).find(".product-price-range").addClass("hide");$(this).find(".product-price-refunds").addClass("hide");i.removeClass("hide")}else{$(this).find(".product-price-range").removeClass("hide");$(this).find(".product-price-refunds").addClass("hide")}});$(".product_price_recept_buy_icon.btn-icon-shopping").removeClass("hide")}if(currenRefundSelectVal===c){return}currenRefundSelectVal=c;if(a.hasClass("product-refund-select-sticky")){select2Change("select.product-refund-select-card",c)}else{if(a.hasClass("product-refund-select-card")){select2Change("select.product-refund-select-sticky",c)}}return false}function select2Change(b,c){var a=$(b);a.find("option").each(function(){$(this).prop("selected",false);if($(this).val()===c){$(this).prop("selected",true)}});a.trigger("change")}if("serviceWorker" in navigator){if(navigator.serviceWorker&&navigator.serviceWorker.controller){}else{navigator.serviceWorker.register("/pwabuilder-sw.js",{scope:"/"}).then(function(a){})}}$.fn.showSpinner=function(a){if(a){$(".spinner-txt").addClass("isVisible");$(".spinner-txt").text(a)}else{$(".spinner-txt").text("");$(".spinner-txt").removeClass("isVisible")}$(".page-loader-layer").show()};$.fn.hideSpinner=function(){$(".spinner-txt").text("");$(".spinner-txt").removeClass("isVisible");$(".page-loader-layer").hide()};var SendGoogleEvent=function(){var a=this;this.SendGoogleEventBasic=function(b){$(document.body).on("click",b.Selector,function(f){var d=$(this).attr(b.DataEventCategory);var g=$(this).attr(b.DataEventAction);var c=$(this).attr(b.DataEventLabel);_gaq.push([b.EventType,d,g,c])})}};